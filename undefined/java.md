# Java 멀티 쓰레드 디자인패턴

## Introduction 01

### 쓰레드란 무엇인가

* start 메소드를 실행해야 자바에서 새로운 쓰레드를 만들어준다
* start 메소드가 실행되면서 run 메소드를 같이 실행해준다
* 따라서 run 메소드를 실행하면 쓰레드가 생성되지 않는다



순차(sequential), 병렬(parallel), 병행(concurrent) 용어 정리

* 순차: 말그대로 순차적으로 실행
* 병렬: 10개의 업무를 2개가 분담하여 실행
* 병행: 어떤 한 task를 어떤 순서로 처리해도 상관없이 여러개의 작업으로 분할, 아래 이미지 참고
  * 예를 들어 cpu가 하나라면 두개의 업무를 마치 하나의 병렬처리하듯이 왔다갔다...
  * cpu가 두개라면 두번째 이미지처럼 같은 시간동안에 task를 말그대로 동시에 실행할 수 있다

<figure><img src="../.gitbook/assets/2022-10-19_18-15-06.png" alt=""><figcaption></figcaption></figure>

### 쓰레드 베타제어 05

돈을 입출금하는 로직이 있을 때 로직상으로 데이터를 체크하고 입출금하는 로직이 문제가 없지만 쓰레드가 concurrent로 처리되면 두개의 쓰레드가 우연히 조건문에 둘다 들어가서 조건에 부합하지 않는데도 로직을 실행할 가능성이 있다.

<figure><img src="../.gitbook/assets/2022-10-20_14-53-58.png" alt=""><figcaption></figcaption></figure>

이를 방지하려면 syncronized 키워드를 메소드 앞에 붙여서 방지할 수 있다. syncronized 를 붙이면 다른 쓰레드가 실행중인 동일한 인스터스의 메소드에 바로 접근하지 못하고 기다려야만 한다.

다른 쓰레드가 접근할 수 없는 것을 락(Lock)이라고 한다. 락에 걸린 상태에서는 synchronized 메소드에 접근할 수 없고 release 될때까지 기다려야한다. release 되면 기다리고 있는 쓰레드들 중에서 하나만 락을 획득(acquire)할 수 있다. 락은 인스턴스마다 존재한다. 따라서 어떤 인스턴스의 synchronized 메소드를 실행할 수 없다고 해서 다른 인스턴스의 synchornized 메소드 또한 실행할 수 없는 것은 아니다.
